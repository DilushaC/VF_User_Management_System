@model UserManagement.Data.Models.LoginViewModel

@{
    ViewData["Title"] = "Login";
    Layout = null;
}
<html class="h-100" lang="en">

<head>
    <meta charset="utf-8" />
    <title>Log In | Attex - Bootstrap 5 Admin & Dashboard Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description" />
    <meta content="Coderthemes" name="author" />

    <!-- App favicon -->
    <link rel="shortcut icon" href="~/assets/images/favicon.ico">

    <!-- Theme Config Js -->
    <script src="~/assets/js/config.js"></script>

    <!-- App css -->
    <link href="~/assets/css/app.min.css" rel="stylesheet" type="text/css" id="app-style" />

    <!-- Icons css -->
    <link href="~/assets/css/icons.min.css" rel="stylesheet" type="text/css" />

</head>

<body class="h-100">

    <!--*******************
        Preloader start
    ********************-->
    <div id="preloader">
        <div class="loader">
            <svg class="circular" viewBox="25 25 50 50">
                <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="3" stroke-miterlimit="10" />
            </svg>
        </div>
    </div>
    <!--*******************
        Preloader end
    ********************-->


    <div class="auth-fluid">
        <!--Auth fluid left content -->
        <div class="auth-fluid-form-box">

            <div class="card-body d-flex flex-column h-100 gap-3">

                <!-- Logo -->
                <div class="auth-brand text-center text-lg-start">
                    <a href="index.html" class="logo-dark">
                        <span><img src="~/assets/images/logo-dark.png" alt="dark logo" height="22"></span>
                    </a>
                    <a href="index.html" class="logo-light">
                        <span><img src="~/assets/images/logo.png" alt="logo" height="22"></span>
                    </a>
                </div>

                <div class="my-auto">

                    <!-- form -->
                    <form class="form-horizontal" asp-action="Login" asp-controller="User" method="post" id="loginForm">

                        <fieldset class="form-group position-relative has-icon-left mb-3">
                            <label asp-for="UserName" class="form-label">User Name</label>
                            <input asp-for="UserName" class="form-control round" placeholder="Enter your UserName" required />
                            <div class="form-control-position" style="margin-top:10px">
                                <i class="ft-mail"></i>
                            </div>
                        </fieldset>

                        <fieldset class="form-group position-relative has-icon-left mb-3">
                            <label asp-for="Password" class="form-label">Password</label>
                            <input asp-for="Password" type="password" class="form-control round" placeholder="Enter your password" required />
                            <div class="form-control-position" style="margin-top:10px">
                                <i class="ft-lock"></i>
                            </div>
                        </fieldset>

                        <div class="form-group text-center d-grid mb-0">
                            <button type="button" class="btn btn-primary round btn-block" onclick="submitLogin()">Login</button>
                        </div>

                    </form>

                    <!-- end form-->
                </div>

                <!-- Footer-->
                <footer class="footer footer-alt">
                    <p class="text-muted">Don't have an account? <a href="auth-register-2.html" class="text-muted ms-1"><b>Sign Up</b></a></p>
                </footer>

            </div> <!-- end .card-body -->
        </div>
        <!-- end auth-fluid-form-box-->
        <!-- Auth fluid right content -->
        <div class="auth-fluid-right text-center">
            <div class="auth-user-testimonial">
                <div id="carouselExampleFade" class="carousel slide carousel-fade" data-bs-ride="carousel">
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            <h2 class="mb-3">I love the color!</h2>
                            <p class="lead">
                                <i class="ri-double-quotes-l"></i> Everything you need is in this template. Love the overall look and feel. Not too flashy, and still very professional and smart.
                            </p>
                            <p>
                                - Admin User
                            </p>
                        </div>
                        <div class="carousel-item">
                            <h2 class="mb-3">Flexibility !</h2>
                            <p class="lead">
                                <i class="ri-double-quotes-l"></i> Pretty nice theme, hoping you guys could add more features to this. Keep up the good work.
                            </p>
                            <p>
                                - Admin User
                            </p>
                        </div>
                        <div class="carousel-item">
                            <h2 class="mb-3">Feature Availability!</h2>
                            <p class="lead">
                                <i class="ri-double-quotes-l"></i> This is a great product, helped us a lot and very quick to work with and implement.
                            </p>
                            <p>
                                - Admin User
                            </p>
                        </div>
                    </div>
                </div>
            </div> <!-- end auth-user-testimonial-->
        </div>
        <!-- end Auth fluid right content -->
    </div>

    <!--**********************************
        Scripts
    ***********************************-->
    <!-- Vendor js -->
    <script src="~/assets/js/vendor.min.js"></script>

    <!-- App js -->
    <script src="~/assets/js/app.min.js"></script>
    <script src="~/assets/js/sweetalert2.all.min.js"></script>
    <script type="text/javascript">

        $("#Error").hide();
        function submitLogin() {
            var form = $("#loginForm");
            $.ajax({
                url: form.attr("/User/Login"), // Uses the form's asp-action and asp-controller
                type: "POST",
                data: form.serialize(),
                headers: { "X-Requested-With": "XMLHttpRequest" },   // Collects all form inputs
                success: function (response) {
                    // ✅ If your controller returns JSON
                    if (response.success) {
                        Swal.fire({
                            title: 'Successfully Login!',
                            text: 'Welcome to User Management System.',
                            icon: 'success',
                            timer: 2000,
                            showConfirmButton: false
                        }).then(() => {
                            window.location.href = response.redirectUrl;
                        });
                    } else if(response.redirectUrl != null){
                         window.location.href = response.redirectUrl
                    } else{
                        $("#Error").text("Invalid username or password!").show();
                    }
                },
                error: function (xhr, status, error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: 'Something went wrong! Please try again.'
                    });
                }
            });
        }
    </script>

    @*     <script type="text/javascript">

        $("#Error").hide();
        function submitLogin() {
            var form = $("#loginForm");
            $.ajax({
                url: form.attr("/User/Login"),
                type: "POST",
                data: form.serialize(),
                headers: { "X-Requested-With": "XMLHttpRequest" },
                success: function (response) {
                    if (response.success) {
                        Swal.fire({
                            title: 'Successfully Login!',
                            text: 'Welcome to User Management System.',
                            icon: 'success',
                            timer: 2000,
                            showConfirmButton: false
                        }).then(() => {
                            window.location.href = response.redirectUrl;
                        });
                    } else if(response.redirectUrl != null){
                         window.location.href = response.redirectUrl
                    } else{
                        $("#Error").text("Invalid username or password!").show();
                    }
                },
                error: function (xhr, status, error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: 'Something went wrong! Please try again.'
                    });
                }
            });
        }
    </script> *@
</body>
</html>